// draw.js
(function($){
$.fn.atom=function(customOptions){var $0={stage:{}};var $1=$.extend({},$0,customOptions);return this.each(function($p1_0,$p1_1){
var $1_0=Custom.StageMaster.fromElement($p1_1,$1.stage);var $1_1=new Custom.Atom($1_0,$1);});}
Type.registerNamespace('Custom');Custom.Atom=function(stage,options){this.$0=stage;var $0=$(stage.getContainer());$0.data('Custom.Atom',this);this.$4=options.electrons;this.$1=new Kinetic.Layer({});this.$5=new Custom.Space3D();this.nucleus=new Custom.Nucleus(this.$1,this.$5);this.$3=[];for(var $2=0;$2<20;$2++){this.$3.add(new Custom.Electron(this.$1));}for(var $3=0;$3<Math.min(20,this.$4.length);$3++){this.$3[$3].set_image(this.$4[$3]);}var $1=this.nucleus.get_center();this.$2=new Kinetic.Animation(ss.Delegate.create(this,function($p1_0){
var $1_0=new Custom.Vector3D(this.$5.axisX.x/64,this.$5.axisY.y/32,Custom.PI.value/256);this.$5.rotate($1_0.x,$1_0.y,$1_0.z);this.moveElectrones(this.$5);}),this.$1);this.$2.start();stage.add(this.$1);}
Custom.Atom.mitter=function(x,y,z){var $0=Custom.Pythagoras.half;return x.rotate(y,$0,$0).rotate(x.rotate(z,$0,$0),$0,$0);}
Custom.Atom.prototype={$0:null,$1:null,$2:null,nucleus:null,$3:null,$4:null,$5:null,get_center:function(){return this.nucleus.get_center();},set_center:function(value){this.nucleus.set_center(value);return value;},get_radius:function(){return this.nucleus.get_radius()*2;},set_radius:function(value){this.nucleus.set_radius(value/2);return value;},moveElectrones:function(g){var $0=new Custom.Vector3D(this.nucleus.circle.getX(),this.nucleus.circle.getY(),0);var $1=this.get_radius();var $2=g.axisX;var $3=g.axisY;var $4=g.axisZ;var $5=$2.plot($1);var $6=$3.plot($1);var $7=$4.plot($1);this.$3[0].set_center($0.translate($5));this.$3[1].set_center($0.translate($6));this.$3[2].set_center($0.translate($7));var $8=$5.image();var $9=$6.image();var $A=$7.image();this.$3[3].set_center($0.translate($8));this.$3[4].set_center($0.translate($9));this.$3[5].set_center($0.translate($A));this.$3[6].set_center($0.translate(Custom.Atom.mitter(g.axisX,g.axisY,g.axisZ).plot($1)));this.$3[7].set_center($0.translate(Custom.Atom.mitter(g.axisX.image(),g.axisY,g.axisZ).plot($1)));this.$3[8].set_center($0.translate(Custom.Atom.mitter(g.axisX,g.axisY.image(),g.axisZ).plot($1)));this.$3[9].set_center($0.translate(Custom.Atom.mitter(g.axisX,g.axisY,g.axisZ.image()).plot($1)));this.$3[10].set_center($0.translate(Custom.Atom.mitter(g.axisX.image(),g.axisY.image(),g.axisZ.image()).plot($1)));this.$3[11].set_center($0.translate(Custom.Atom.mitter(g.axisX,g.axisY.image(),g.axisZ.image()).plot($1)));this.$3[12].set_center($0.translate(Custom.Atom.mitter(g.axisX.image(),g.axisY,g.axisZ.image()).plot($1)));this.$3[13].set_center($0.translate(Custom.Atom.mitter(g.axisX.image(),g.axisY.image(),g.axisZ).plot($1)));var $B=Math.atan(-$3.z/$4.z);var $C=Math.atan(-$4.z/$2.z);var $D=Math.atan(-$2.z/$3.z);var $E=Custom.Sphere.plot($B,$1,$3,$4);var $F=Custom.Sphere.plot($C,$1,$4,$2);var $10=Custom.Sphere.plot($D,$1,$2,$3);this.$3[14].set_center($0.translate($E));this.$3[15].set_center($0.translate($F));this.$3[16].set_center($0.translate($10));var $11=$E.image();var $12=$F.image();var $13=$10.image();this.$3[17].set_center($0.translate($11));this.$3[18].set_center($0.translate($12));this.$3[19].set_center($0.translate($13));},setWidth:function(width){var $0=34*width/100;this.nucleus.circle.setX($0+(width-$0)/2);},setHeight:function(height){this.nucleus.circle.setY(height/2);}}
Custom.Electron=function(layer){this.$0=new Image();this.$1=new Kinetic.Image({x:-9999,y:-9999,width:80,height:80,image:this.$0});this.$2=0;layer.add(this.$1);}
Custom.Electron.prototype={$0:null,$1:null,$2:null,get_center:function(){return new Custom.Vector3D(this.$1.getX()+this.$1.getWidth()/2,this.$1.getY()+this.$1.getHeight()/2,this.$2);},set_center:function(value){this.$1.setX(value.x-this.$1.getWidth()/2);this.$1.setY(value.y-this.$1.getHeight()/2);this.$2=value.z;var $0=8+this.$2/2;this.$1.setZIndex(parseInt($0));return value;},get_image:function(){return this.$0.src;},set_image:function(value){this.$0.src=value;return value;}}
Custom.Nucleus=function(layer,axes){this.circle=new Kinetic.Circle({x:100,y:100,radius:160,fill:'#ccc',stroke:'#ccc',strokeWidth:1,drawFunc:ss.Delegate.create(this,function($p1_0){
this.circle.__proto__.drawFunc.call(this.circle, canvas);var $1_0=$p1_0.getContext();this.paint($1_0,this.circle.getRadius(),10,axes);})});var $0=this.circle.getZIndex();layer.add(this.circle);}
Custom.Nucleus.prototype={circle:null,get_center:function(){return new Custom.Vector3D(this.circle.getX(),this.circle.getY(),0);},set_center:function(value){this.circle.setX(value.x);this.circle.setY(value.y);return value;},get_radius:function(){return this.circle.getRadius();},set_radius:function(value){this.circle.setRadius(value);return value;},paint:function(ctx,r,d,axes){var $0=Math.sqrt(r*r-d*d);var $1=Math.asin(d/r);var $2=new Array(8);var $3=[new Custom.Color('#9c6'),new Custom.Color('#693'),new Custom.Color('#369'),new Custom.Color('#69c'),new Custom.Color('#69c'),new Custom.Color('#369'),new Custom.Color('#693'),new Custom.Color('#9c6')];for(var $4=0;$4<8;$4++){$2[$4]=new Custom.R8($4,$3[$4]);}ctx.lineJoin='round';for(var $5=0;$5<8;$5++){var $6=$2[$5];$6.update(axes,d,$0);if(!Support.get_radialGradient()){ctx.fillStyle=$6.color._value;}else{try{var $7=new Custom.Color($6.color._value);var $8=this.get_center();var $9=$8.translate(Custom.Curve.plot(Custom.PI.value/4,r));var $A=ctx.createRadialGradient($8.x,$8.y,r,$9.x,$9.y,r);$A.addColorStop(0,$7.lighter(0.2));$A.addColorStop(0.5,$7._value);$A.addColorStop(1,$7.darker(0.2));ctx.fillStyle=$A;}catch($B){ctx.fillStyle=$6.color.get_value();}}if($6.traceSurface(ctx,axes,$1,r,d,$0)){ctx.fill();}}}}
Custom.R8=function(index,color){this.index=index;this.color=color;this.vector3D=new Custom.Vector3D(1,1,1);this.x=new Custom.Vector3D(1,0,0);this.y=new Custom.Vector3D(0,1,0);this.z=new Custom.Vector3D(0,0,1);}
Custom.R8.prototype={color:null,index:0,vector3D:null,x:null,y:null,z:null,update:function(system,d,h){var $0=7-this.index;var $1=this.vector3D=new Custom.Vector3D((($0<<1)&2)-1,($0&2)-1,(($0>>1)&2)-1);var $2=system.axisX.plot($1.x);var $3=system.axisY.plot($1.y);var $4=system.axisZ.plot($1.z);var $5=Custom.Pythagoras.half*$1.x*$1.y*$1.z;var $6=Custom.Pythagoras.half;var $7=$2.rotate($3,$5,$6);var $8=$3.rotate($4,$5,$6);var $9=$4.rotate($2,$5,$6);this.x=$7.plot(d/$6).translate($2.plot(h));this.y=$8.plot(d/$6).translate($3.plot(h));this.z=$9.plot(d/$6).translate($4.plot(h));},traceSurface:function(ctx,system,mhu,r,d,h){var $0=system.center;var $1=this.vector3D;var $2=this.x;var $3=this.y;var $4=this.z;if($2.z<0&&$3.z<0&&$4.z<0){return false;}var $5=$0.translate($2);var $6=$0.translate($3);var $7=$0.translate($4);var $8=system.axisX.plot($1.x);var $9=system.axisY.plot($1.y);var $A=system.axisZ.plot($1.z);var $B=$0.translate($8.plot(d));var $C=$0.translate($9.plot(d));var $D=$0.translate($A.plot(d));var $E=new Custom.Vector3D(mhu,mhu,mhu);var $F=new Custom.Vector3D(Custom.PI.value/2-mhu,Custom.PI.value/2-mhu,Custom.PI.value/2-mhu);if($2.z>0&&$3.z>0&&$4.z>0){ctx.moveTo($6.x,$6.y);ctx.beginPath();ctx.moveTo($6.x,$6.y);Custom.Sphere.traceArc(ctx,$B,$6,h,$E.x,$F.x,$9,$A);Custom.Sphere.traceArc(ctx,$C,$7,h,$E.y,$F.y,$A,$8);Custom.Sphere.traceArc(ctx,$D,$5,h,$E.z,$F.z,$8,$9);ctx.closePath();}else{var $10=0,$11=0,$12=0,$13=0,$14=0,$15=0;var $16=$5,$17=$5,$18=$6,$19=$6,$1A=$7,$1B=$7;if($2.z<0){$F.y=Math.atan(-$4.z/$2.z);$E.z=Math.atan(-$2.z/$3.z);$16=$C.translate(Custom.Sphere.plot($F.y,h,$A,$8));$17=$D.translate(Custom.Sphere.plot($E.z,h,$8,$9));$11=Custom.Vector3D.angle($0,$17);$10=Custom.Vector3D.angle($0,$16);}if($3.z<0){$E.x=Math.atan(-$3.z/$4.z);$F.z=Math.atan(-$2.z/$3.z);$18=$B.translate(Custom.Sphere.plot($E.x,h,$9,$A));$19=$D.translate(Custom.Sphere.plot($F.z,h,$8,$9));$12=Custom.Vector3D.angle($0,$18);$13=Custom.Vector3D.angle($0,$19);}if($4.z<0){$F.x=Math.atan(-$3.z/$4.z);$E.y=Math.atan(-$4.z/$2.z);$1A=$B.translate(Custom.Sphere.plot($F.x,h,$9,$A));$1B=$C.translate(Custom.Sphere.plot($E.y,h,$A,$8));$14=Custom.Vector3D.angle($0,$1A);$15=Custom.Vector3D.angle($0,$1B);}if($2.z>0&&$3.z>0){ctx.strokeStyle='#f00';ctx.moveTo($1A.x,$1A.y);ctx.beginPath();Custom.Sphere.traceArc(ctx,$C,$1B,h,$E.y,$F.y,$A,$8);Custom.Sphere.traceArc(ctx,$D,$17,h,$E.z,$F.z,$8,$9);Custom.Sphere.traceArc(ctx,$B,$18,h,$E.x,$F.x,$9,$A);Custom.Curve.smallArc(ctx,$0,$1A,r,$14,$15);}else if($3.z>0&&$4.z>0){ctx.strokeStyle='#0f0';ctx.moveTo($17.x,$17.y);ctx.beginPath();Custom.Sphere.traceArc(ctx,$D,$17,h,$E.z,$F.z,$8,$9);Custom.Sphere.traceArc(ctx,$B,$18,h,$E.x,$F.x,$9,$A);Custom.Sphere.traceArc(ctx,$C,$1A,h,$E.y,$F.y,$A,$8);Custom.Curve.smallArc(ctx,$0,$16,r,$10,$11);}else if($4.z>0&&$2.z>0){ctx.strokeStyle='#00f';ctx.moveTo($18.x,$18.y);ctx.beginPath();Custom.Sphere.traceArc(ctx,$B,$18,h,$E.x,$F.x,$9,$A);Custom.Sphere.traceArc(ctx,$C,$1A,h,$E.y,$F.y,$A,$8);Custom.Sphere.traceArc(ctx,$D,$17,h,$E.z,$F.z,$8,$9);Custom.Curve.smallArc(ctx,$0,$19,r,$13,$12);}else if($2.z>0){ctx.strokeStyle='#0ff';ctx.moveTo($1B.x,$1B.y);ctx.beginPath();Custom.Sphere.traceArc(ctx,$C,$1B,h,$E.y,$F.y,$A,$8);Custom.Sphere.traceArc(ctx,$D,$17,h,$E.z,$F.z,$8,$9);Custom.Curve.smallArc(ctx,$0,$19,r,$13,$15);}else if($3.z>0){ctx.strokeStyle='#ff0';ctx.moveTo($17.x,$17.y);ctx.beginPath();Custom.Sphere.traceArc(ctx,$D,$17,h,$E.z,$F.z,$8,$9);Custom.Sphere.traceArc(ctx,$B,$18,h,$E.x,$F.x,$9,$A);Custom.Curve.smallArc(ctx,$0,$1A,r,$14,$11);}else if($4.z>0){ctx.strokeStyle='#f0f';ctx.moveTo($18.x,$18.y);ctx.beginPath();Custom.Sphere.traceArc(ctx,$B,$18,h,$E.x,$F.x,$9,$A);Custom.Sphere.traceArc(ctx,$C,$1B,h,$E.y,$F.y,$A,$8);Custom.Curve.smallArc(ctx,$0,$16,r,$10,$12);}}return true;}}
Custom.Curve=function(){}
Custom.Curve.plot=function(phi,r){return new Custom.Vector3D(Math.sin(phi)*r,Math.cos(phi)*r,0);}
Custom.Curve.smallArc=function(ctx,center,context,r,a,b){if(a===b){return false;}if(a>b&&a-b>Custom.PI.value){a=a-2*Custom.PI.value;}else if(b>a&&b-a>Custom.PI.value){b=b-2*Custom.PI.value;}Custom.Curve.traceArc(ctx,center,context,r,a,b);return true;}
Custom.Curve.traceArc=function(ctx,center,context,r,a,b){var $0=b-a;var $1=Custom.PI.value/16;var $2=Math.abs(Math.ceil($0/$1));if(!$2){return context;}var $3=$0/$2;var $4=a;var $5=($3<0)?-Custom.Epsilon.value:Custom.Epsilon.value;for(var $6=0;$6<$2;$6++){var $7=$4+$3;var $8=center.translate(Custom.Curve.plot($7,r));var $9=Custom.Vector3D.calcControl(context,center.translate(Custom.Curve.plot($4+$5,r)),center.translate(Custom.Curve.plot($7-$5,r)),$8);ctx.quadraticCurveTo($9.x,$9.y,$8.x,$8.y);$4=$7;context=$8;}return context;}
Custom.Curve.drawArc=function(ctx,center,context,r,a,b,color){ctx.strokeStyle=color;ctx.moveTo(context.x,context.y);ctx.beginPath();context=Custom.Curve.traceArc(ctx,center,context,r,a,b);ctx.stroke();return context;}
Custom.Curve.traceCircle=function(ctx,center,r){return Custom.Curve.traceArc(ctx,center,center.translate(new Custom.Vector3D(r,0,0)),r,0,2*Custom.PI.value);}
Custom.Curve.drawCircle=function(ctx,center,r,color){return Custom.Curve.drawArc(ctx,center,new Custom.Vector3D(r,0,0),r,0,2*Custom.PI.value,color);}
Custom.Curve.traceCircleDeprecated=function(ctx,center,r){var $0=Custom.PI.value/4;var $1=Custom.PI.value/8;var $2=Math.sin($0);var $3=Math.tan($1);var $4=center.x;var $5=center.y;ctx.quadraticCurveTo(r+$4,-$3*r+$5,$2*r+$4,-$2*r+$5);ctx.quadraticCurveTo($3*r+$4,-r+$5,$4,-r+$5);ctx.quadraticCurveTo(-$3*r+$4,-r+$5,-$2*r+$4,-$2*r+$5);ctx.quadraticCurveTo(-r+$4,-$3*r+$5,-r+$4,$5);ctx.quadraticCurveTo(-r+$4,$3*r+$5,-$2*r+$4,$2*r+$5);ctx.quadraticCurveTo(-$3*r+$4,r+$5,$4,r+$5);ctx.quadraticCurveTo($3*r+$4,r+$5,$2*r+$4,$2*r+$5);ctx.quadraticCurveTo(r+$4,$3*r+$5,r+$4,$5);}
Custom.Curve.drawCircleDeprecated=function(ctx,center,r,color){ctx.beginPath();ctx.strokeStyle=color;ctx.moveTo(center.x+r,center.y);Custom.Curve.traceCircleDeprecated(ctx,center,r);ctx.stroke();}
Custom.Color=function(color){this._value=color;color=color.replace(new RegExp('^\\s*|\\s*$'),'');color=color.replace(new RegExp('^#?([a-f0-9])([a-f0-9])([a-f0-9])$'),'#$1$1$2$2$3$3');var $0=color.match(new RegExp('^rgba?\\(\\s*'+'(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])'+'\\s*,\\s*'+'(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])'+'\\s*,\\s*'+'(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])'+'(?:\\s*,\\s*'+'(0|1|0?\\.\\d+))?'+'\\s*\\)$','i'));if($0!=null){this._rgb=true;this._alpha=($0[4]!=null)?parseInt($0[4]):0;this._red=parseInt($0[1]);this._green=parseInt($0[2]);this._blue=parseInt($0[3]);}else{var $1=color.match(new RegExp('^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])'));this._rgb=false;this._alpha=0;this._red=parseInt($1[1],16);this._green=parseInt($1[2],16);this._blue=parseInt($1[3],16);}}
Custom.Color.prototype={_red:0,_green:0,_blue:0,_alpha:0,_value:null,_rgb:false,get_value:function(){return this._value;},lighter:function(ratio){var $0=Math.round(ratio*256);var $1=Math.min(this._red+$0,255);var $2=Math.min(this._green+$0,255);var $3=Math.min(this._blue+$0,255);var $4=(this._rgb)?((!!this._alpha)?String.format('rgba({0}, {1}, {2}, {3})',$1,$2,$3,this._alpha):String.format('rgb({0}, {1}, {2})',$1,$2,$3)):String.concat('#',$1.toString(16),$2.toString(16),$3.toString(16));return $4;},darker:function(ratio){var $0=-Math.round(ratio*256);var $1=Math.max(this._red+$0,0);var $2=Math.max(this._green+$0,0);var $3=Math.max(this._blue+$0,0);var $4=(this._rgb)?((!!this._alpha)?String.format('rgba({0}, {1}, {2}, {3})',$1,$2,$3,this._alpha):String.format('rgb({0}, {1}, {2})',$1,$2,$3)):String.format('#{0:x2}{1:x2}{2:x2}',$1,$2,$3);return $4;}}
Custom.Space3D=function(){this.axisX=new Custom.Vector3D(1,0,0);this.axisY=new Custom.Vector3D(0,1,0);this.axisZ=new Custom.Vector3D(0,0,1);this.center=new Custom.Vector3D(0,0,0);}
Custom.Space3D.prototype={axisX:null,axisY:null,axisZ:null,center:null,drawVisibleAxes:function(ctx,r,color){Custom.Sphere.drawVisibleArc(ctx,this.center,r,this.axisY,this.axisZ,color);Custom.Sphere.drawVisibleArc(ctx,this.center,r,this.axisZ,this.axisX,color);Custom.Sphere.drawVisibleArc(ctx,this.center,r,this.axisX,this.axisY,color);},drawVisibleMesh:function(ctx,r,count,color){this.drawVisibleAxes(ctx,r,color);var $0=r/count;for(var $1=1;$1<count;$1++){var $2=$1*$0;var $3=Math.sqrt(r*r-$2*$2);Custom.Sphere.drawVisibleArc(ctx,this.center.translate(this.axisX.plot($2)),$3,this.axisY,this.axisZ,color);Custom.Sphere.drawVisibleArc(ctx,this.center.translate(this.axisX.plot(-$2)),$3,this.axisY,this.axisZ,color);Custom.Sphere.drawVisibleArc(ctx,this.center.translate(this.axisY.plot($2)),$3,this.axisZ,this.axisX,color);Custom.Sphere.drawVisibleArc(ctx,this.center.translate(this.axisY.plot(-$2)),$3,this.axisZ,this.axisX,color);Custom.Sphere.drawVisibleArc(ctx,this.center.translate(this.axisZ.plot($2)),$3,this.axisX,this.axisY,color);Custom.Sphere.drawVisibleArc(ctx,this.center.translate(this.axisZ.plot(-$2)),$3,this.axisX,this.axisY,color);}},rotate:function(x,y,z){var $0=new Custom.Vector3D(x,y,z);if(!!x){var $1=Math.cos($0.x);var $2=Math.sin($0.x);this.axisX.rotateX($1,$2);this.axisY.rotateX($1,$2);this.axisZ.rotateX($1,$2);}if(!!y){var $3=Math.cos($0.y);var $4=Math.sin($0.y);this.axisX.rotateY($3,$4);this.axisY.rotateY($3,$4);this.axisZ.rotateY($3,$4);}if(!!z){var $5=Math.cos($0.z);var $6=Math.sin($0.z);this.axisX.rotateZ($5,$6);this.axisY.rotateZ($5,$6);this.axisZ.rotateZ($5,$6);}},translate:function(x,y,z){this.center.x+=x;this.center.y+=y;this.center.z+=z;}}
Custom.Sphere=function(){}
Custom.Sphere.traceArc=function(ctx,center,context,r,a,b,u,v){var $0=b-a;var $1=Custom.PI.value/16;var $2=Math.abs(Math.ceil($0/$1));$2=8;var $3=$0/$2;var $4=a;for(var $5=0;$5<$2;$5++){var $6=$4+$3;var $7=center.translate(Custom.Sphere.plot($6,r,u,v));var $8=Custom.Vector3D.calcControl(context,center.translate(Custom.Sphere.plot($4+Custom.Epsilon.value,r,u,v)),center.translate(Custom.Sphere.plot($6-Custom.Epsilon.value,r,u,v)),$7);ctx.quadraticCurveTo($8.x,$8.y,$7.x,$7.y);$4=$6;context=$7;}return context;}
Custom.Sphere.drawVisibleArc=function(ctx,center,r,u,v,color){var $0=0;var $1=2*Custom.PI.value;if(!!v.z){$0=Math.atan(-u.z/v.z);if(v.z<0){$0=$0+Custom.PI.value;}if($0<0){$0=2*Custom.PI.value+$0;}else if($0>2*Custom.PI.value){$0=$0-2*Custom.PI.value;}$1=$0+Custom.PI.value;}ctx.beginPath();ctx.strokeStyle=color;var $2=Custom.Sphere.traceArc(ctx,center,null,r,$0,$1,u,v);ctx.stroke();return $2;}
Custom.Sphere.plot=function(rho,r,u,v){var $0=r*Math.cos(rho);var $1=r*Math.sin(rho);var $2=new Custom.Vector3D($0*u.x+$1*v.x,$0*u.y+$1*v.y,$0*u.z+$1*v.z);return $2;}
Custom.Vector3D=function(x,y,z){Custom.Vector3D.initializeBase(this);this.x=x;this.y=y;this.z=z;}
Custom.Vector3D.angle=function(center,point){var $0=point.x-center.x;var $1=point.y-center.y;var $2=Math.atan(Math.abs($0/$1));if($0<0&&$1<0){$2=Custom.PI.value+$2;}else if($0<0){$2=2*Custom.PI.value-$2;}else if($1<0){$2=Custom.PI.value-$2;}return $2;}
Custom.Vector3D.calcControl=function(context,midA,midB,ending){var $0=(context.x-midA.x);var $1=(midB.x-ending.x);var $2=(context.y-midA.y);var $3=(midB.y-ending.y);var $4=$0*$3-$2*$1;var $5=(context.x*midA.y-context.y*midA.x);var $6=(midB.x*ending.y-midB.y*ending.x);var $7=($5*$1-$0*$6)/$4;var $8=($5*$3-$2*$6)/$4;var $9=context.z+(ending.z-context.z)/2;return new Custom.Vector3D($7,$8,$9);}
Custom.Vector3D.prototype={length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);},normalize:function(){var $0=this.length();this.x=this.x/$0;this.y=this.y/$0;this.z=this.z/$0;},crossProduct:function(vector){return new Custom.Vector3D(this.y*vector.z-this.z*vector.y,this.z*vector.x-this.x*vector.z,this.x*vector.y-this.y*vector.x);},image:function(){return new Custom.Vector3D(-this.x,-this.y,-this.z);},plot:function(r){return new Custom.Vector3D(this.x*r,this.y*r,this.z*r);},rotate:function(vector,sin,cos){var $0=1-cos;var $1=this.x;var $2=this.y;var $3=this.z;var $4=$1*$1;var $5=$2*$2;var $6=$3*$3;var $7=$2*$3;var $8=$3*$1;var $9=$1*$2;var $A=cos+$4*$0;var $B=$9*$0-$3*sin;var $C=$8*$0+$2*sin;var $D=$9*$0+$3*sin;var $E=cos+$5*$0;var $F=$7*$0-$1*sin;var $10=$8*$0-$2*sin;var $11=$7*$0+$1*sin;var $12=cos+$6*$0;var $13=$A*vector.x+$B*vector.y+$C*vector.z;var $14=$D*vector.x+$E*vector.y+$F*vector.z;var $15=$10*vector.x+$11*vector.y+$12*vector.z;return new Custom.Vector3D($13,$14,$15);},rotateX:function(cos,sin){var $0=cos*this.y-sin*this.z;var $1=sin*this.y+cos*this.z;this.y=$0;this.z=$1;this.normalize();},rotateY:function(cos,sin){var $0=cos*this.x+sin*this.z;var $1=cos*this.z-sin*this.x;this.x=$0;this.z=$1;this.normalize();},rotateZ:function(cos,sin){var $0=cos*this.x-sin*this.y;var $1=sin*this.x+cos*this.y;this.x=$0;this.y=$1;this.normalize();},toString:function(){return '(x: '+this.x.toString()+'; y: '+this.y.toString()+'; z: '+this.z.toString()+')';},translate:function(v){return new Custom.Vector3D(v.x+this.x,v.y+this.y,v.z+this.z);},dotProduct:function(v){return new Custom.Vector3D(v.x*this.x,v.y*this.y,v.z*this.z);}}
Custom.StageMaster=function(){}
Custom.StageMaster.fromElement=function(element,options){var $0=$(element);var $1=$0.data('Custom.Stage');if($1==null){$1=new Kinetic.Stage({container:element});$0.data('Custom.Stage',$1);}return $1;}
Custom.Atom.registerClass('Custom.Atom');Custom.Electron.registerClass('Custom.Electron');Custom.Nucleus.registerClass('Custom.Nucleus');Custom.R8.registerClass('Custom.R8');Custom.Curve.registerClass('Custom.Curve');Custom.Color.registerClass('Custom.Color');Custom.Space3D.registerClass('Custom.Space3D');Custom.Sphere.registerClass('Custom.Sphere');Custom.Vector3D.registerClass('Custom.Vector3D',Object);Custom.StageMaster.registerClass('Custom.StageMaster');})(jQuery);// This script was generated using Script# v0.7.4.0
